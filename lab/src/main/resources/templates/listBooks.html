<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Book Reservation - Welcome and choose a Book</title>
  <style type="text/css">
    body {
      width: 800px;
      margin: auto;
      font-family: Arial, sans-serif;
    }
    h1 {
      color: #333;
    }
    form {
      margin-top: 20px;
    }
    .book-option {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .book-option:hover {
      background-color: #f5f5f5;
    }
  </style>
</head>
<body>
<header>
  <h1>Welcome to our Book Reservation App</h1>
</header>
<main>
  <h2>Recently viewed:</h2>
  <li th:each="lastViewedBook : ${lastVisitedBooks}"
      th:text="'Title: ' + ${lastViewedBook.title} + ', Genre: ' + ${lastViewedBook.genre} + ', Rating: ' + ${lastViewedBook.averageRating}">
  </li>

  <form th:action="@{/books}" th:method="GET">
<!--    <label>-->
<!--      <input type="text" th:value="${title}" name="title" placeholder="Search book by title">-->
<!--    </label>-->
<!--    <label>-->
<!--      <input type="text" th:value="${rating}" name="rating" placeholder="Search book by rating">-->
<!--    </label>-->
    <label>
        <select id="authorId" name="authorId">
            <option value="">Select Author</option>
            <option th:each="author : ${authors}"
                    th:value="${author.id}"
                    th:text="${author.name} + ' ' + ${author.surname}"
                    th:selected="${authorId} == ${author.id}">
            </option>        </select>
      <input type="text" th:value="${authorId}" name="authorId" placeholder="Search books by author id">
    </label>
    <br>
    <button type="submit">Search</button>
    <div class="msg" style="color: red;" th:if="${errorMessage}" th:text="${errorMessage}"></div>
  </form>

  <div th:each="book : ${books}" style="display:flex; justify-content: space-between; align-items: center; padding:10px; border:1px solid #ddd; border-radius:5px; margin:5px 0;" >
    <div style="flex-grow: 1;">
<!--      <p th:id="${book.getId()}" th:value="${book.title}" th:text="'Title: '+${book.getTitle()}+', Genre:' + ${book.getGenre()}+', Rating: '+${book.getAverageRating()}+', Author: '+${book.getAuthor().getName()}+' '+${book.getAuthor().getSurname()}+', Date: '+${book.getDateCreated()}"></p><br/>-->
      <p th:id="${book.getId()}" th:value="${book.title}" th:text="'Title: '+${book.getTitle()}+', Genre:' + ${book.getGenre()}+', Rating: '+${book.getAverageRating()}+', Author: '+${book.getAuthor().getName()}+' '+${book.getAuthor().getSurname()}"></p><br/>
    </div>
    <div style="align-items: center; flex-shrink: 0; display: flex; gap: 5px">
    <form th:action="@{/books/delete/{id}(id=${book.id})}" th:method="POST">
      <button class="btn-danger" type="submit">Delete</button>
    </form>
<!--      <form th:action="@{/books/like/{id}(id=${book.id})}" th:method="post">-->
<!--        <button type="submit">Like(<span th:text="${book.getLikes()}"></span>)</button>-->
<!--      </form>-->
    <th:block>
      <a class="btn btn-sm btn-info edit-book" th:href="@{'/books/edit-form/{id}' (id=${book.id})}">
        Edit
      </a>
    </th:block>
  </div>
  </div>

  <form th:method="POST" th:action="@{/bookReservation}">
    <div class="col mb-3">
      <div class="row">
        <div class="col-sm-12 col-md-12">
          <a href="/books/add-form" class="btn btn-block btn-dark add-product-btn">
            Add new Book
          </a>
        </div>
      </div>
    </div>
    <div class="form-group">
      <h2>Choose a book:</h2>
      <select name="title" class="form-control">
        <option th:each="book : ${books}" th:text="${book.getTitle()}" th:value="${book.getTitle()}"></option>
      </select>
    </div>
    <!-- Display radio buttons for each book,
         the value should be the book title
         and the displayed text should be:
         Title: <book_title>, Genre: <book_genre>, Rating: <average_rating> -->


    <h2>Enter your information:</h2>
    <label>Your Name:</label>
    <input type="text" name="readerName" required><br/>
    <label>Your Address:</label>
    <input type="text" name="readerAddress" required><br/>

    <h2>Choose number of copies:</h2>
    <input type="number" name="numCopies" min="1" max="10" required><br/>
    <br/>
    <input type="submit" value="Reserve Book">
  </form>
</main>
</body>
</html>